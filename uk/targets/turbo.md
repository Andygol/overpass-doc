Overpass Turbo
==============

Стандартний інструмент для створення запитів.

<a name="overview"/>
## Огляд

Overpass Turbo – вебсайт для надсилання запитів до Overpass API та візуалізації результатів на мапі.

Багато прикладів у цьому посібнику посилаються на Overpass Turbo із заздалегідь визначеним запитами.

Загально доступний сайт знаходиться за посиланням [https://overpass-turbo.eu](https://overpass-turbo.eu).
Він, так само як і Overpass API, має відкриті сирці,
які можна відшукати на [Github](https://github.com/tyrasd/overpass-turbo).
Мартін Райфер (Martin Raifer) розробив Overpass Turbo,
за що йому велика шана як за ідею, так і за її втілення.

Майже всі вихідні формати, які видає Overpass API, сприймаються Overpass Turbo.
Досить великі за обсягом результати можуть викликати певні труднощі;
рушії JavaScript навіть в сучасних вебоглядачах не завжди добре пораються з розподілом пам'яті.
З цих причин Overpass Turbo запитає у вас, чи потрібно отримувати результати, 
щоб не підвісити ваш оглядач, якщо їх обсяг завеликий.

У Overpass Turbo є багато популярних та корисних функцій,
але їх опис виходить за межі цього посібника.
Натомість ви можете ознайомитись з [документацією по Overpass Turbo](https://wiki.openstreetmap.org/wiki/Overpass_turbo) у ВікіОСМ.
Там ви можете дізнатись про такі можливості, як застосування _стилів_ та використання _помічника_ для створення запитів.
Цей посібник зосереджений на безпосередній взаємодії між Overpass Turbo та мовою запитів Overpass.

<a name="basics"/>
## Основи

Інтерфейс вебсайту складається з кількох частин;
вони мають різне розташування для настільної та мобільної версії сайту.
Відкрийте [сайт](https://overpass-turbo.eu) в окремій вкладці вашого оглядача.

В настільній версії ліворуч знаходиться велике поле для вводу тексту;
введіть або вставте ваш запит тут.
Праворуч знаходиться рухома мапа.
Праворуч вгорі над нею дві вкладки, за допомогою яких можна перемикатись між мапою та безпосереднім 
переглядом даних, отриманих в результаті виконання запитів.

В мобільній версії текстове поле знаходиться вгорі над мапою.
Друге текстове поле, нижче мапи, містить дані отримані в результаті виконання запиту.
Замість вкладок ви перемикаєтесь між двома частинами шляхом інтенсивної прокрутки.

Спробуйте стандартний спосіб:
введіть цей текст у поле для запитів…

    nwr[name="Canary Wharf"];
    out geom;

… або скористайтесь цим [посиланням](https://overpass-turbo.eu/?lat=51.4775&lon=0.0&zoom=18&Q=CGI_STUB)!

Тепер натисніть на кнопку _Execute_.
Через секунду індикатор прогресу попросить вас набратися терпіння.
Потім ви побачите майже те саме, що і раніше.

Натисніть на кнопку з лупою.
Дивіться на лівому краю мапи, третя кнопка зверху,
під кнопками плюс і мінус.
Рухома мапа переміститься до центру території з вашими результатами та змінить масштаб мапи,
так щоб показати їх всі у вашому оглядачі.

Об’єкти, показані поверх мапи, це саме ті об’єкти, які знайшов запит.

Часто корисно переглядати отримані дані так як вони були отримані в необробленому вигляді.
Це можна зробити натиснувши на вкладку _Data_ у верхньому куті праворуч, або спустившись нижче
в мобільній версії.

Тим часом усі показані на мапі об'єкти можна натискати 
та переглядати, залежно від ступеня деталізації запиту, 
їх ідентифікатор, теґи та метадані.

За певних обставин ви отримаєте попередження, що геометрія отримана не для всіх об'єктів.
Після чого ви можете скористатись автодоповненням запиту.
Або замініть всі `out` в запиті на `out geom`.

Якщо ви очікуєте великого результату
або якщо ви все одно хочете обробити результат іншим інструментом, ніж Overpass Turbo
тоді ви можете безпосередньо експортувати дані без спроби їх показу на мапі:
Натисніть кнопку _Export_ та в розділі _Data_
оберіть `raw data directly from Overpass API`.
Для тривалих запитів це нормально
що, майже нічого не відбувається після запуску виконання запиту.

Пропонуємо вам звернути увагу на дві корисні функції:

* У нижньому правому куті перегляду карти
  лічильник показує, скільки об’єктів кожного типу було повернуто в останньому запиті.
* У верхньому лівому куті є поле для пошуку місця.
  Попри те, що він менш потужний, ніж [Nominatim на openstreetmap.org](../criteria/nominatim.md),
  зазвичай цього досить щоб знайти назву міста, щоб перемістити положення мапи до нього.

<a name="symbols"/>
## Позначки

В [документації до Overpass Turbo](https://wiki.openstreetmap.org/wiki/Overpass_turbo) є опис того, що означає той чи інший кольори.
Розглянемо натомість тут взаємодію:
Для певного об'єкта чи типу об'єкта ви матимете уяву
чи то точка, лінія, або поєднання їх обох, щось абстрактне чи щось з нечіткою межею.
В структурі даних OpenStreetMap це відбувається певним чином,
що може збігатись чи ні з вашими очікуваннями.

Overpass API пропонує [інструменти](formats.md#extras)
для зміни подання даних OpenStreetMap у вигляді що краще пасує поточним потребам.
Ці зміни можуть відбуватись шляхом змін координат, спрощення геометрії або [відкидання](../full_data/bbox.md#crop) надлишку.
Overpass Turbo намагається показувати дані в найкращий спосіб,
незалежно від того, чи має сенс представлення відповідно до моделі даних OpenStreetMap,
чи вихідний формат, обраний у запиті, відповідає даним чи ні.

Цей розділ містить пояснення
до якого вигляду врешті-решт призводить такий стан речей
та як на це впливає запит та дані.

Об'єкти, що показуються точками, можуть мати жовте або червоне забарвлення.
Об'єкти з жовтим забарвленням є _точками_,
в той час як об'єкти з червоним забарвленням – це _лінії_.

Лінії можуть стискатись до точок через їх невелику довжину
бо в іншому разі вони стають непомітними на мапі.
Будь ласка, віддалиться у [цьому прикладі](https://overpass-turbo.eu/?lat=51.477&lon=0.0&zoom=19&Q=CGI_STUB)
щоб побачити як будинки та дороги перетворюються у точки!

    ( way({{bbox}})[building];
      way({{bbox}})[highway=steps]; );
    out geom;

Якщо це ускладнює подання конкретного результату,
ви можете відключити це в налаштуваннях: _Settings_, _Map_, _Don't display small features as POIs_.
Налаштування набувають чинності після виконання наступного запиту (або того ж самого запиту знову).

Або об'єкти стискаються тому що в цьому [запиті](https://overpass-turbo.eu/?lat=51.477&lon=0.0&zoom=19&Q=CGI_STUB) є інструкція показувати тільки точки центру об'єктів - `out center`:

    way({{bbox}})[building];
    out center;

Точкові об'єкти можуть мати блакитний чи пурпуровий контур;
це також стосується відрізків та полігонів.
У всіх цих випадках ми [маємо справу](https://overpass-turbo.eu/?lat=51.5045&lon=-0.0195&zoom=16&Q=CGI_STUB) зі _зв'язками_:

    rel[name="Canary Wharf"];
    out geom;

На відміну від _точок_ та _ліній_, інформація про _зв'язок_ не показується при натисканні на об'єкт,
натомість у вікні з інформацією об'єкта є посилання на сторінку зв'язка на сайті osm.org.
За звичайних обставин це не проблема.

Але, якщо ви запросили відмінності між поточною та колишньою версією об'єкта,
дані на головній сторінки будуть містити поточну версію, що 
відрізняються від даних які було повернуто на ваш запит.
Тож, вам треба дивитись на необроблені дані на вкладці _Data_.

Якщо лінія чи межі показані пунктиром,
це означає що отримана геометрія об'єкта не є повною.

Майже завжди це передбачуваний ефект від [обрізки виводу](../full_data/bbox.md#crop) ([приклад](https://overpass-turbo.eu/?lat=51.4765&lon=0.0&zoom=16&Q=CGI_STUB)):

    (
      way(51.475,-0.002,51.478,0.003)[highway=unclassified];
      rel(bw);
    );
    out geom(51.475,-0.002,51.478,0.003);

Але це також може бути наслідком запиту
що додав до _лінії_ деякі, але не всі _точки_.
Тут ми завантажуємо _лінії_ що створюються з _точок_,
але ми [забули](https://overpass-turbo.eu/?lat=51.4765&lon=0.0&zoom=17&Q=CGI_STUB)
запитати точки, що знаходяться за межами обмежувального прямокутника:

    (
      node(51.475,-0.003,51.478,0.003);
      way(bn);
    );
    out;

Цей запит [можна виправити](https://overpass-turbo.eu/?lat=51.4765&lon=0.0&zoom=17&Q=CGI_STUB) додавши `out geom`;
більше варіантів ви можете знайти в розділі - [геометрія](../full_data/osm_types.md#nodes_ways):

    (
      node(51.475,-0.003,51.478,0.003);
      way(bn);
    );
    out geom;

<a name="convenience"/>
## Зручності

Overpass Turbo пропонує деякі зручності.

Він може використовувати поточний вид мап для обмеження території запиту.
Він замінює в кожному рядку текст `{{bbox}}` на координати кутів мапи,
що використовуються як координати обмежувального прямокутника.

Ви можете дізнатись координати обмежувального прямокутника
додавши  [цей рядок](https://overpass-turbo.eu/?lat=51.4765&lon=0.0&zoom=17&Q=CGI_STUB) у будь-яку
частину вашого запиту (та запустивши його на виконання):

    make example info_text="The current bounding box is {{bbox}}";
    out;

Другою зручною функцією керує кнопка _Share_ у верхньому лівому куті.
Вона дозволяє отримати постійне посилання на запит,
який знаходився в полі вводу в момент її натискання.
Навіть якщо хтось інший скориставшись цим посиланням змінить запит,
посилання буде вказувати на оригінальний запит.

Також можливо, за допомогою прапорця, передати координати поточного вигляду мапи.
Це виглядає як координати центру мапи та рівень масштабування,
звісно розмір видимої мапи буде відрізнятися, в залежності від розміру екрану користувача.

<a name="limitations"/>
## Обмеження

Overpass Turbo може зрозуміти практично всі варіанти виводу Overpass API.
Одна все одно є певні обмеження.

Для кожного ідентифікатора об'єкта та типу Overpass Turbo показує лише один об'єкт.
Тож, [відмінності](index.md) не можуть бути візуалізовані в Overpass Turbo.

Overpass Turbo не показує [GeoJSON](../targets/formats.md#json) безпосередньо з Overpass API.
Overpass Turbo має власний модуль для перетворення в GeoJSON,
і Мартин з насторогою ставиться до того, що користувачі плутаються,
коли обидва механізми працюють паралельно.
Зараз для показу GeoJSON вам краще скористатись експериментальним сервером - [https://olbricht.nrw/ovt/](https://olbricht.nrw/ovt/).
