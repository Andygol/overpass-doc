Обмежувальний прямокутник
=========================

Це найпростіший спосіб отримати дані OpenStreetMap для невеликої території.

<a name="filter"/>
## Фільтрування запитів

Для того, щоб отримати дані з прямокутної ділянки, простіше за все
явним чином зазначити це ([Посилання](https://overpass-turbo.eu/?lat=51.4775&lon=0.0&zoom=16&Q=CGI_STUB)):

    nwr(51.477,-0.001,51.478,0.001);
    out;

Тут координати `(51.477,-0.001,51.478,0.001)` визначають обмежувальний прямокутник.
Порядок ребер прямокутника завжди однаковий:

* `51.477` - _широта_ південне ребро.
* `-0.001` - _довгота_ of the західне ребро.
* `51.478` - _широта_ of the північне ребро.
* `0.001` - _довгота_ of the східне ребро.

API Overpass використовує лише позначення координат у вигляді десяткових дробів, 
позначення у хвилинах і секундах не підтримується.

Значення південного ребра завжди має бути меншим за значення північного ребра,
оскільки значення широти зростають від південного полюса до північного,
від -90,0 до +90,0.

На відміну від цього, значення ступеня довготи зростають із заходу на схід майже скрізь.
Але на антимеридіані значення перескакують з +180,0 до -180,0.
Антимеридіан перетинає на своєму шляху від північного полюса до південного полюса Тихий океан і маже більше нічого.
Таким чином, майже у всіх випадках значення західного ребра менше, ніж значення східного ребра,
якщо хтось дійсно не хоче розтягнути обмежувальний прямокутник через антимеридіан.

Зазвичай зазначення обмежувального прямокутника вручну - нудна справа.
Тому майже всі [Застосунки](../targets/index.md) мають певні зручності для того, щоб робити це автоматично.
В [Overpass Turbo](../targets/turbo.md#convenience) так само як і в [JOSM](../targets/index.md),
текст `{{bbox}}` замінюється координатами з поточного вигляду мапи.
Отже, можна користуватись таким узагальненим [запитом](https://overpass-turbo.eu/?lat=51.4775&lon=0.0&zoom=16&Q=CGI_STUB):

    nwr({{bbox}});
    out;

Тоді запит завжди виконується для поточної видимої частини мапи.

Зверніть увагу на те, що деякі елементи показуються пунктиром.
Це явна ознака більш масштабного явища,
ми розглянемо це далі в [наступному розділі](osm_types.md).
Об’єкти, про які йдеться, були повністю jnhsvfyb з огляду на їх синтаксичну структуру,
але вони мають неповну геометрію, тому що ми неявно вказали на це у запиті.

<a name="crop"/>
## Обрізання виводу

Це наступний спосіб використання обмежувального прямокутника.
Вивід `out geom` можна обмежити просторовими обмеженнями.
Якщо вам потрібно показати _лінію_ чи _зв'язок_ на мапі,
вам потрібно [явним чином вказати](../targets/formats.md#extras)  Overpass API, що для цього
потрібні координати, що відхиляється від моделі даних OpenStreetMap.

У випадку зі зв'язками це може призвести для отримання великих обсягів даних.
Ось типовий приклад,
у [цьому випадку](https://overpass-turbo.eu/?lat=51.4775&lon=0.0&zoom=16&Q=CGI_STUB) ми отримуємо геометрію, що простягається на пів Англії, натомість нам потрібні лише кількасот метрів:

    relation(51.477,-0.001,51.478,0.001);
    out geom;

Обсяг даних можна скоротити [явно зазначивши](https://overpass-turbo.eu/?lat=51.4775&lon=0.0&zoom=16&Q=CGI_STUB), що потрібно використовувати обмежувальний прямокутник:

    relation(51.477,-0.001,51.478,0.001);
    out geom(51.47,-0.01,51.49,0.01);

Координати прямокутника потрібно записати одразу після `geom`.
Ці координати можуть збігатись або бути відмінними від координат, що містяться в самому запиті.
У цьому випадку ми обрали дуже широкий діапазон
за допомогою більшого обмежувального прямокутника для виводу, ніж для запиту.

Для явно обмеженого виводу, _точки_ будуть показані, якщо вони потрапляють в обмежувальний прямокутник.

Для _ліній_, будуть показані не тільки координати _точок_, що входять в прямокутник, але й наступна та попередня точки лінії, за межами прямокутника.
Щоб побачити це на [прикладі](https://overpass-turbo.eu/?lat=51.4775&lon=0.0&zoom=18&Q=CGI_STUB),
перейдіть на вкладку _Дані_ після виконання запиту.
Пересуваючи мапу навколо можна побачити де геометрію було обрізано:

    way[name="Blackheath Avenue"](51.477,-0.001,51.478,0.001);
    out geom(51.477,-0.002,51.479,0.002);

Тільки частина _точок_ з цього прикладу мають координати.

Ті відрізки, що мають координати, кожної окремої лінії [можуть бути роз'єднані](https://overpass-turbo.eu/?lat=51.4735&lon=-0.007&zoom=17&Q=CGI_STUB), навіть в межах однієї лінії:

    way[name="Hyde Vale"];
    out geom(51.472,-0.009,51.475,-0.005);

Таке трапляється, якщо лінія має помітний вигин, що виходить за межі обмежувального прямокутника, 
як у цьому прикладі.

Для _зв'язків_, їх _члени_, що є _лініями_ і які простягатися за межі обмежувального прямокутника
як мінімум на одну _точку_, доповнюються координатами.
Для цих _ліній_, як і для _ліній_ що є самі по собі,
_точки_ які знаходяться в середини прямокутника плюс одна точка за його межами, доповнюються координатами.

Як і для обмежувального прямокутника, що використовуються як фільтри,
більшість програмного забезпечення може використовувати їх підстановку для обрізання виводу.
В [Overpass Turbo](../targets/turbo.md#convenience) текст `{{bbox}}` замінюється координатами поточного вигляду мапи, [наприклад](https://overpass-turbo.eu/?lat=51.4775&lon=0.0&zoom=16&Q=CGI_STUB):

    relation({{bbox}});
    out geom({{bbox}});

<a name="global"/>
## Глобальні фільтри

…
